# RPC Plugin

Generate Kitex RPC servers from `.proto` files.

## Overview

The RPC plugin generates production-ready [Kitex](https://github.com/cloudwego/kitex) RPC servers with:

- Server and logic layer separation
- ServiceContext pattern for dependency injection
- Consul service discovery integration
- OpenTelemetry tracing integration
- Prometheus metrics server with health checks
- Graceful shutdown

## Installation

```bash
ss plugin install github.com/ssgohq/ss-plugin-rpc
```

## Prerequisites

- [kitex](https://github.com/cloudwego/kitex) - `go install github.com/cloudwego/kitex/tool/cmd/kitex@latest`
- [protoc](https://grpc.io/docs/protoc-installation/) - Protocol Buffers compiler

## Quick Start

### 1. Create a proto file

```bash
ss rpc new user
```

This creates `idl/user.proto`:

```protobuf
syntax = "proto3";

package user;

option go_package = "user";

message GetUserRequest {
  int64 id = 1;
}

message GetUserResponse {
  int64 id = 1;
  string name = 2;
  string email = 3;
}

service UserService {
  rpc GetUser(GetUserRequest) returns (GetUserResponse);
}
```

### 2. Generate the server

```bash
ss rpc gen -p idl/user.proto --service UserService -m github.com/myorg/user-rpc
```

### 3. Run the server

```bash
go mod tidy
go run cmd/main.go -c etc/config.yaml
```

## Generated Structure

```
user-rpc/
├── cmd/
│   └── main.go                 # Entry point
├── internal/
│   ├── config/
│   │   └── config.go           # Config struct
│   ├── server/
│   │   └── user_server.go      # Server handler
│   ├── logic/
│   │   └── get_user_logic.go   # Business logic
│   └── svc/
│       └── service_context.go  # Service context
├── kitex_gen/                  # Generated by kitex
│   └── user/
│       ├── user.pb.go
│       └── userservice/
├── etc/
│   └── config.yaml
└── go.mod
```

## Next Steps

- [Proto Format](./proto) - Learn the `.proto` file format
- [Configuration](./config) - Configure your RPC server
- [CLI Reference](./cli) - Full command reference
